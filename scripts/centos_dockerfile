FROM centos:centos7

# Update yum repository
RUN yum update -y

# Install wget to download CMake sources
RUN yum install -y \
    wget \
    redhat-lsb-core \
    zlib-devel \
    openssl-devel \
    libjpeg-turbo-devel \
    rpm-build

# CMake
RUN mkdir -p /tmp/cmake && \
    pushd /tmp/cmake && \
    wget 'https://github.com/Kitware/CMake/releases/download/v3.13.2/cmake-3.13.2-Linux-x86_64.sh' && \
    bash cmake-3.13.2-Linux-x86_64.sh --prefix=/usr/local --exclude-subdir && \
    popd && \
    rm -rf /tmp/cmake

# GCC
RUN yum install -y \
    centos-release-scl
RUN yum install -y \
    devtoolset-7-gcc*
ENV PATH="/opt/rh/devtoolset-7/root/usr/bin:$PATH"
RUN source scl_source enable devtoolset-7

# Repository cleanup after everything was installed
RUN yum clean all

# Build directory
RUN mkdir -p /src
WORKDIR /src

